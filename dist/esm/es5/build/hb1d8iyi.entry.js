import{h}from"../project-huddle-ui.core.js";var Draggable=function(){function t(){var t=this;this.hasDragged=!1,this.active=!1,this.currentX=0,this.currentY=0,this.initialX=0,this.initialY=0,this.xOffset=0,this.yOffset=0,this.container=window.parent,this.behavior="fixed",this.dragStart=function(e){console.log("start",e),"touchstart"===e.type?(t.initialX=e.touches[0].clientX-t.xOffset,t.initialY=e.touches[0].clientY-t.yOffset):(t.initialX=e.clientX-t.xOffset,t.initialY=e.clientY-t.yOffset),e.target.closest("ph-draggable")===t.el&&(t.start.emit(t),t.active=!0)},this.dragEnd=function(e){console.log("end",e),t.initialX=t.currentX,t.initialY=t.currentY,t.active&&t.end.emit(t),t.active=!1},this.drag=function(e){if(console.log("maybedrag",e),t.active){console.log("drag",e),e.preventDefault(),t.hasDragged=!0,"touchmove"===e.type?(t.currentX=e.touches[0].clientX-t.initialX,t.currentY=e.touches[0].clientY-t.initialY):(t.currentX=e.clientX-t.initialX,t.currentY=e.clientY-t.initialY),t.xOffset=t.currentX,t.yOffset=t.currentY;var n=t.el.getBoundingClientRect();(n.x<0&&t.currentX<parseInt(t.el.dataset.currentX)||n.x+n.width>t.container.innerWidth&&t.currentX>parseInt(t.el.dataset.currentX))&&(t.currentX=parseInt(t.el.dataset.currentX)),(n.y<0&&t.currentY<parseInt(t.el.dataset.currentY)||n.y+n.height>t.container.innerHeight&&t.currentY>parseInt(t.el.dataset.currentY))&&(t.currentY=parseInt(t.el.dataset.currentY)),t.dragging.emit(t),t.el.style.transform="translate3d("+t.currentX+"px, "+t.currentY+"px, 0)",t.el.dataset.currentX=t.currentX.toString(),t.el.dataset.currentY=t.currentY.toString()}},this.maybeReset=function(){t.isOutsideContainer()&&t.reset()},this.isOutsideContainer=function(){var e=t.el.getBoundingClientRect();return e.x<0||e.y<0||e.x+e.width>t.container.innerWidth||e.y+e.height>t.container.innerHeight},this.reset=function(){t.el.style.transform="translate3d(0px, 0px, 0)",t.el.dataset.currentX="0",t.el.dataset.currentY="0",t.xOffset=0,t.yOffset=0}}return t.prototype.hostData=function(){return{class:{"ph-has-dragged-fixed":this.hasDragged&&"fixed"==this.behavior,"ph-has-dragged-absolute":this.hasDragged&&"absolute"==this.behavior}}},t.prototype.componentWillLoad=function(){window.addEventListener("resize",this.maybeReset,!1),this.container.addEventListener("touchstart",this.dragStart,!1),this.container.addEventListener("touchend",this.dragEnd,!1),this.container.addEventListener("touchmove",this.drag,!1),this.container.addEventListener("mousedown",this.dragStart,!1),this.container.addEventListener("mouseup",this.dragEnd,!1),this.container.addEventListener("mousemove",this.drag,!1)},t.prototype.render=function(){return h("slot",null)},Object.defineProperty(t,"is",{get:function(){return"ph-draggable"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{active:{state:!0},behavior:{type:String,attr:"behavior"},container:{type:"Any",attr:"container"},currentX:{state:!0},currentY:{state:!0},el:{elementRef:!0},hasDragged:{state:!0},initialX:{state:!0},initialY:{state:!0},xOffset:{state:!0},yOffset:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"events",{get:function(){return[{name:"start",method:"start",bubbles:!0,cancelable:!0,composed:!0},{name:"dragging",method:"dragging",bubbles:!0,cancelable:!0,composed:!0},{name:"end",method:"end",bubbles:!0,cancelable:!0,composed:!0}]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return":host(.ph-has-dragged-absolute),:host(.ph-has-dragged-fixed){position:fixed}"},enumerable:!0,configurable:!0}),t}();export{Draggable as PhDraggable};